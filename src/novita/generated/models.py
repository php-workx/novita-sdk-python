# generated by datamodel-codegen:
#   filename:  novita-api.yaml
#   timestamp: 2025-10-25T09:15:17+00:00

from __future__ import annotations

from enum import Enum
from typing import Annotated, Any, Optional

from pydantic import BaseModel, Field


class InstanceType(Enum):
    """
    Type of GPU instance
    """

    a100_80_gb = "A100_80GB"
    a100_40_gb = "A100_40GB"
    a10 = "A10"
    l40 = "L40"
    rtx_4090 = "RTX_4090"
    rtx_a6000 = "RTX_A6000"


class CreateInstanceRequest(BaseModel):
    name: Annotated[str, Field(description="Name for the instance", examples=["my-gpu-instance"])]
    instance_type: Annotated[
        InstanceType, Field(description="Type of GPU instance", examples=["A100_80GB"])
    ]
    disk_size: Annotated[int | None, Field(description="Disk size in GB", ge=20, le=1000)] = 50
    ssh_key: Annotated[str | None, Field(description="SSH public key for access")] = None


class UpdateInstanceRequest(BaseModel):
    name: Annotated[str | None, Field(description="New name for the instance")] = None
    disk_size: Annotated[
        int | None, Field(description="New disk size in GB", ge=20, le=1000)
    ] = None


class CreateInstanceResponse(BaseModel):
    instance_id: Annotated[
        str, Field(description="ID of the created instance", examples=["inst-abc123"])
    ]
    status: Annotated[
        str, Field(description="Initial status of the instance", examples=["PENDING"])
    ]


class Status(Enum):
    pending = "PENDING"
    creating = "CREATING"
    running = "RUNNING"
    stopped = "STOPPED"
    failed = "FAILED"
    terminating = "TERMINATING"


class InstanceInfo(BaseModel):
    instance_id: Annotated[str, Field(description="Unique identifier")]
    name: Annotated[str, Field(description="Instance name")]
    instance_type: Annotated[str, Field(description="GPU type")]
    status: Status
    disk_size: Annotated[int, Field(description="Disk size in GB")]
    created_at: Annotated[int, Field(description="Creation timestamp")]
    ssh_host: str | None = None
    ssh_port: int | None = None
    jupyter_url: str | None = None


class InstanceActionResponse(BaseModel):
    instance_id: Annotated[str, Field(description="Instance ID")]
    success: Annotated[bool, Field(description="Whether the action succeeded")]
    message: Annotated[str | None, Field(description="Optional message")] = None


class ListInstancesResponse(BaseModel):
    instances: list[InstanceInfo]
    total: Annotated[int, Field(description="Total number of instances")]


class SubscriptionPrice(BaseModel):
    price: Annotated[int, Field(description="Unit price for the subscription instance")]
    month: Annotated[int, Field(description="Subscription duration, in months")]


class GPUProduct(BaseModel):
    id: Annotated[str, Field(description="Product ID")]
    name: Annotated[str, Field(description="Product name")]
    cpu_per_gpu: Annotated[int, Field(alias="cpuPerGpu", description="Number of CPU cores per GPU")]
    memory_per_gpu: Annotated[
        int, Field(alias="memoryPerGpu", description="Memory size per GPU (GB)")
    ]
    disk_per_gpu: Annotated[int, Field(alias="diskPerGpu", description="Disk size per GPU (GB)")]
    available_deploy: Annotated[
        bool,
        Field(
            alias="availableDeploy",
            description="Whether this product can be used to create an instance",
        ),
    ]
    min_root_fs: Annotated[
        int,
        Field(alias="minRootFS", description="Minimum available root filesystem size (GB)"),
    ]
    max_root_fs: Annotated[
        int,
        Field(alias="maxRootFS", description="Maximum available root filesystem size (GB)"),
    ]
    min_local_storage: Annotated[
        int,
        Field(
            alias="minLocalStorage",
            description="Minimum available local storage size (GB)",
        ),
    ]
    max_local_storage: Annotated[
        int,
        Field(
            alias="maxLocalStorage",
            description="Maximum available local storage size (GB)",
        ),
    ]
    regions: Annotated[list[str], Field(description="Available clusters")]
    price: Annotated[int, Field(description="Price for creating a pay-as-you-go instance")]
    monthly_price: Annotated[
        list[SubscriptionPrice],
        Field(
            alias="monthlyPrice",
            description="Price for creating a subscription instance",
        ),
    ]
    billing_methods: Annotated[
        list[str],
        Field(alias="billingMethods", description="Supported billing methods"),
    ]
    spot_price: Annotated[str, Field(alias="spotPrice", description="Spot billing instance price")]


class ListGPUProductsResponse(BaseModel):
    data: Annotated[list[GPUProduct], Field(description="List of GPU product information")]


class ErrorResponse(BaseModel):
    message: str
    details: dict[str, Any] | None = None
